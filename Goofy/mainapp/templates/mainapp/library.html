{% extends "mainapp/base.html" %}
{% load static %}


{% block title %}Library{% endblock title %}
{% block content %}
<div id="allelements" class="pt-8 flex flex-col ml-2 sm:ml-[100px] ">

    <div class="flex-col poppins-regular mt-16 ">


        <div class="text-white flex w-[98%] justify-between">
            <div class="flex space-x-5">
                <div class="text-white text-[30px] montserrat">Your Playlists</div>

            </div>
            <div id="scrollnavbtn" class="flex">
                <button class="hover:scale-110" onclick="horizontalscroll(true,'playlistgrid')">
                    <div class="m-1"><img src="{% static 'mainapp/homepageassets/larrow.svg' %}" alt=""></div>
                </button>
                <button class="hover:scale-110" onclick="horizontalscroll(false,'playlistgrid')">
                    <div class="m-1"><img src="{% static 'mainapp/homepageassets/rarrow.svg' %}" alt=""></div>
                </button>
            </div>
        </div>

        <div id="playlistgrid"
            class="scrollbar  sm:hover:overflow-x-scroll sm:overflow-hidden h-64  w-[98%] pt-4 pl-3 scroll-smooth space-x-5 ">

            <button data-modal-target="crud-modal" data-modal-toggle="crud-modal" class="hover:scale-110">
                <div class="w-40 ">
                    <img src="{% static 'mainapp/libraryassets/createplaylist.svg' %}" alt="">
                </div>
                <div class="text-white w-40 pt-1 text-container">
                    <span class="text-white w-40 ">
                        Create Playlist
                    </span>
                </div>

            </button>

        </div>
        <div id="crud-modal" tabindex="-1" aria-hidden="true"
            class="hidden fixed inset-0 z-50 flex items-center justify-center bg-[#161617] bg-opacity-50 border-white border-r-4">

            <div class="relative p-4 w-full max-w-md max-h-full">
                <!-- Modal content -->
                <div class="relative bg-white rounded-lg shadow dark:bg-black">
                    <!-- Modal header -->
                    <div class="p-4 md:p-5 border-b rounded-t border-black dark:border-white">
                        <h3 class="text-lg font-semibold text-black dark:text-white">
                            New Playlist
                        </h3>
                    </div>

                    <!-- Modal body -->
                    <form class="p-4 md:p-5" method="post" action="{% url 'createPlaylist' %}">
                        {% csrf_token %}
                        <div class="grid gap-4 mb-4 grid-cols-2">
                            <div class="col-span-2">
                                <label for="name"
                                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Title</label>
                                <input type="text" name="name" id="name"
                                    class="bg-white border border-black text-black text-sm rounded-lg focus:ring-white focus:border-white block w-full p-2.5 dark:bg-black dark:border-white dark:placeholder-gray-300 dark:text-white dark:focus:ring-white dark:focus:border-white"
                                    placeholder="Type playlist title" required>
                            </div>
                            <div class="col-span-2">
                                <label for="description"
                                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Description</label>
                                <textarea id="description" name="description" rows="4"
                                    class="block p-2.5 w-full text-sm text-black bg-white rounded-lg border border-black focus:ring-white focus:border-white dark:bg-black dark:border-white dark:placeholder-gray-300 dark:text-white dark:focus:ring-white dark:focus:border-white"
                                    placeholder="Write playlist description here"></textarea>
                            </div>
                        </div>
                     
                        <button type="submit"
                            class="bg-white text-black hover:bg-black hover:border-white hover:border-r-2 hover:text-white focus:ring-4 focus:outline-none focus:ring-white rounded-lg border border-black text-sm font-medium px-5 py-2.5 focus:z-10">
                            Create
                        </button>
                        <button type="button" data-modal-close="crud-modal"
                            class="text-white inline-flex items-center bg-black hover:bg-[#161617] focus:ring-2 focus:outline-none focus:ring-white font-medium rounded-lg text-sm px-5 py-2.5 text-center">
                            Cancel
                        </button>
                    </form>

                </div>
            </div>
        </div>

    </div>
</div>
{% endblock content %}
{% block script %}
<script>
    $('#libimg').attr("src","{% static 'mainapp/homepageassets/library1.svg' %}");
    $('#homeimg').attr("src","{% static 'mainapp/homepageassets/home2.svg' %}");
    $('#exploreimg').attr("src","{% static 'mainapp/homepageassets/explore2.svg' %}");
    $('#likedsongsimg').attr("src","{% static 'mainapp/homepageassets/mylikes2.svg' %}");
    $('#profileimg').attr("src","{% static 'mainapp/homepageassets/profile2.svg' %}");



    $('#homebox').removeClass('hover:border-l-[#5398C9]').addClass('hover:border-l-white');
    $('#explorebox').removeClass('hover:border-l-[#5398C9]').addClass('hover:border-l-white');
    $('#librarybox').removeClass('hover:border-l-[#5398C9]').addClass('hover:border-l-white');
    $('#likedsongsbox').removeClass('hover:border-l-[#5398C9]').addClass('hover:border-l-white');
    $('#profilebox').removeClass('hover:border-l-[#5398C9]').addClass('hover:border-l-white');
    $('#lchild').removeClass("bg-transparent");
    $('#lchild').addClass("gradnav");
</script>
<script>
    $.ajax({
        url: "{% url 'getPlaylists' %}",
        type: "GET",
        success: function (response) {
            response.playlists.forEach(playlist => {
                $("#playlistgrid").append(
                    `
                    <button class="hover:scale-110" playlistId = "${playlist.playlist_id}"">
                        <div class="w-40 ">
                            <img src="{% static 'mainapp/libraryassets/songdp.svg' %}" alt="">
                        </div>
                        <div class="text-white w-40 pt-1 ">
                            <span class="text-white w-40 ">
                                ${playlist.name}
                            </span>
                        </div>
                    </button>
                        `
                )
            });
        }
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const modalToggle = document.querySelector('[data-modal-toggle="crud-modal"]');
        const modalClose = document.querySelector('[data-modal-close="crud-modal"]');
        const modal = document.getElementById('crud-modal');

        modalToggle.addEventListener('click', function () {
            modal.classList.toggle('hidden');
        });

        modalClose.addEventListener('click', function () {
            modal.classList.toggle('hidden');
        });
    });
</script>
{% endblock script %}